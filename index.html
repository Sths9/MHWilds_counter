<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>モンスター狩猟数カウンター</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      background: #f9f9f9;
      margin: 20px;
    }
    h1 {
      margin-bottom: 20px;
    }

    .grid {
  display: grid;
  grid-template-columns: repeat(6, 120px);
  gap: 10px 35px;
  justify-content: center;
  margin-bottom: 60px;
}



    .monster {
      background: #fff;
      border: 2px solid #ccc;
      border-radius: 10px;
      padding: 10px;
      width: 120px;
      cursor: pointer;
      transition: transform 0.1s ease;
    }
    .monster:hover {
      transform: scale(1.05);
      border-color: #888;
    }
    .monster img {
  width: 80px;
  height: 80px;
  object-fit: contain;
  filter: drop-shadow(2px 0 0 black)
          drop-shadow(-2px 0 0 black)
          drop-shadow(0 2px 0 black)
          drop-shadow(0 -2px 0 black);
}


    .count, .count-input {
  margin-top: 8px;
  font-size: 18px;
  font-weight: bold;
  color: #333;
  width: 60px;
  height: 30px;
  text-align: center;
  display: flex;
  justify-content: center;
  align-items: center;
  margin-left: auto;
  margin-right: auto;
}

    .count-input {
      font-size: 16px;
      padding: 2px;
    }
    .control-bar {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: #333;
      padding: 10px;
      display: flex;
      justify-content: center;
      gap: 20px;
    }
    .control-bar button {
      background: #555;
      color: #fff;
      border: none;
      padding: 10px 20px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 16px;
      transition: background 0.2s;
    }
    .control-bar button.active {
      background: #ff9800;
    }
    .control-bar button:hover {
      background: #777;
    }
  </style>
</head>
<body>
  <h1>モンスター狩猟数カウンター</h1>
  <div class="grid" id="monsterGrid"></div>

  <div class="control-bar">
    <button id="plusBtn">+</button>
    <button id="minusBtn">-</button>
    <button id="editBtn">編集</button>
  </div>

  <script>
    const monsterCount = 32;
    const grid = document.getElementById('monsterGrid');
    let mode = "plus";

    function loadCounts() {
      const saved = localStorage.getItem("monsterCounts");
      return saved ? JSON.parse(saved) : Array(monsterCount).fill(0);
    }

    function saveCounts() {
      localStorage.setItem("monsterCounts", JSON.stringify(counts));
    }

    let counts = loadCounts();

    for (let i = 1; i <= monsterCount; i++) {
      const monster = document.createElement('div');
      monster.className = 'monster';
      monster.innerHTML = `
        <img src="png/${i}.png" alt="Monster ${i}">
        <div class="count" id="count-${i}">${counts[i-1]}</div>
      `;
      monster.addEventListener('click', () => handleClick(i));
      grid.appendChild(monster);
    }

    function handleClick(i) {
      if (mode === "edit") return;

      if (mode === "plus") {
        counts[i-1]++;
      } else if (mode === "minus") {
        counts[i-1] = Math.max(0, counts[i-1] - 1);
      }
      updateCountDisplay(i);
      saveCounts();
    }

    function updateCountDisplay(i) {
      const el = document.getElementById(`count-${i}`);
      el.textContent = counts[i-1];
    }

    const editBtn = document.getElementById("editBtn");
    const plusBtn = document.getElementById("plusBtn");
    const minusBtn = document.getElementById("minusBtn");

    function setMode(newMode) {
      mode = newMode;
      [editBtn, plusBtn, minusBtn].forEach(btn => btn.classList.remove("active"));

      if (mode === "edit") {
        editBtn.classList.add("active");
        enterEditMode();
      } else if (mode === "plus") {
        plusBtn.classList.add("active");
        exitEditMode();
      } else if (mode === "minus") {
        minusBtn.classList.add("active");
        exitEditMode();
      }
    }

    function enterEditMode() {
      for (let i = 1; i <= monsterCount; i++) {
        const el = document.getElementById(`count-${i}`);
        if (el.tagName.toLowerCase() === "div") {
          const value = counts[i-1];
          const input = document.createElement("input");
          input.type = "number";
          input.value = value;
          input.className = "count-input";
          input.id = `count-${i}`;

          input.addEventListener("input", () => {
            counts[i-1] = parseInt(input.value) || 0;
            saveCounts();
          });
          el.replaceWith(input);
        }
      }
    }

    function exitEditMode() {
      for (let i = 1; i <= monsterCount; i++) {
        const el = document.getElementById(`count-${i}`);
        if (el.tagName.toLowerCase() === "input") {
          const value = parseInt(el.value) || 0;
          counts[i-1] = value;
          const div = document.createElement("div");
          div.className = "count";
          div.id = `count-${i}`;
          div.textContent = value;
          el.replaceWith(div);
        }
      }
      saveCounts();
    }

    editBtn.addEventListener("click", () => setMode("edit"));
    plusBtn.addEventListener("click", () => setMode("plus"));
    minusBtn.addEventListener("click", () => setMode("minus"));

    setMode("plus");
  </script>
</body>
</html>
